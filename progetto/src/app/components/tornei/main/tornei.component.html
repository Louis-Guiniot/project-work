<div class="box">
    <div class="wrapper">
        <div class="text content">
            <p>
                Questa Ã¨ la pagina di <span class="primary-text">elenco</span> dei tornei online al momento. <br> Qui potrai <span class="primary-text">iscriverti</span> e <span class="primary-text">giocare</span> a tutti i tornei disponibili. Inoltre
                potrai vedere il <span class="primary-text">dettaglio</span> di ognuno di essi.</p>


        </div>
    </div>
    <div class="count-tournaments">
        <button class="btn contrast-button">tornei online {{torneiOnline}}</button>
    </div>
    <div class="grid-cards">

        <ng-container class="item" *ngFor="let torneo of mieiTornei| async ">
            <ng-container *ngIf="torneo.idCreatore != idCreatore">
                <div class="card" [ngClass]="{'torneo-card-full' : torneo.postiLiberi == 0}">
                    <div class="card-body">
                        <div class="card-intestazione">
                            <span class="detail-span primary-text" (click)="openDetailModal(detailTorneo, torneo.id, torneo.nome)">{{torneo.nome}}</span>
                            <h3 class="card-subtitle mb-2 text-muted">{{torneo.gioco}} - {{torneo.piattaforma}}</h3>
                        </div>
                        <div class="card-informazioni">
                            <p class="text">
                                Iscrizioni al momento {{torneo.iscrizioni}}
                                <br> Posti liberi <span class="posti-full">{{torneo.postiLiberi}}</span>
                                <br> Stato <span class="primary-text posti-full">{{torneo.stato | uppercase}}</span> <br>
                                <span *ngFor="let utente of utenti | async">
                                    <span *ngIf="utente.id == torneo.idCreatore" class="text create-by"
                                        (click)="openPlayerDetailModal(dettaglioGlobale, utente.id, utente.username)">
                                        Creato da
                                        <span class="primary-text posti-full">
                                            {{utente.username | uppercase}}
                                        </span>
                                </span>
                                </span>
                            </p>

                        </div>

                        <div class="card-button">
                            <button class="btn btn-card posti-full" (click)="openIscrivitiModal(iscrivitiModal, torneo.id)" [disabled]="torneo.postiLiberi == 0">
                                <i class="bi bi-controller"></i>
                            </button>
                        </div>


                    </div>
                </div>
            </ng-container>

        </ng-container>
    </div>

    <ng-template #detailTorneo let-modal>
        <div class="modal-header ">
            <h4 class="modal-title ">Dettaglio torneo - {{nomeTorneoDaVedere}}</h4>
            <button type="button " class="close " aria-label="Close " (click)="modal.dismiss( 'Cross click') ">
                <i class="bi bi-x-circle-fill"></i>
            </button>
        </div>
        <div *ngFor="let torneo of mieiTornei | async">
            <div *ngIf="torneo.id == idTorneoDaVedere">
                <div class="modal-body step-modal">

                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true" ngbTooltip="generali"><i class="bi bi-info-circle"></i>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false" ngbTooltip="requisiti"><i class="bi bi-gear-wide-connected"></i>
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false" ngbTooltip="premi"><i class="bi bi-trophy-fill"></i>
        
                            </button>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div class="row">
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Nome</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.nome}}" readonly>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Gioco</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.gioco}}" readonly>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Piattaforma</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.piattaforma}}" readonly>
                                    </div>
                                </div>
                            </div>


                            <div class="row">
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Descrizione</label>
                                        <textarea type="text" class="input-field" placeholder="{{torneo.descrizione}}" readonly></textarea>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div class="row">
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Partite</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.partite}}" readonly>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Quota</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.quota}}" readonly>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Posti Max</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.capienza}}" readonly>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="input-container">
                                        <label class="icon text">Posti Min</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.capienzaMinima}}" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                            <div class="row">
                                <div class="col-6">
                                    <div class="input-container">
                                        <label class="icon text">Primo premio</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.premioPrimo}}" readonly>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-6">
                                    <div class="input-container">
                                        <label class="icon text">Secondo premio</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.premioSecondo}}" readonly>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-6">
                                    <div class="input-container">
                                        <label class="icon text">Terzo premio</label>
                                        <input type="text" class="input-field" placeholder="{{torneo.premioTerzo}}" readonly>
                                    </div>
                                </div>
                            </div>


                        </div>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" (click)="modal.close('Close click')" ngbAutofocus>
                        chiudi
                    </button>
                </div>
            </div>
        </div>
    </ng-template>

    <ng-template #iscrivitiModal let-modal>
        <div class="modal-header ">
            <h4 class="modal-title ">Iscrizione torneo</h4>
            <button type="button " class="close " aria-label="Close " (click)="modal.dismiss( 'Cross click') ">
                <i class="bi bi-x-circle-fill"></i>

            </button>
        </div>
        <div class="modal-body">
            <ng-container *ngIf="!iscritto && !simulato">
                <div class="text">
                    <p>Sei pronto per giocare ?<br> Clicca su <span class="primary-text">iscriviti</span> per confermare l'iscrizione al torneo.
                    </p>
                </div>
            </ng-container>
            <ng-container *ngIf="iscritto && !simulato">
                <div class="text">
                    <p>
                        Iscrizione <span class="primary-text">completata</span>, siamo pronti! <br> Ora non resta che
                        <span class="primary-text">simulare</span> il torneo. <br> I tuoi punti e quelli dei tuoi avversari verranno generati <span class="primary-text">casualmente</span>.
                        <br> Che la forza sia con te.
                    </p>
                </div>
            </ng-container>
            <ng-container *ngIf="simulato">
                <div class="text">
                    <p>
                        Simulazione <span class="primary-text">completata</span>, ora vai a vedere il tuo risultato!
                        <br> Avrai vinto?
                    </p>
                </div>
            </ng-container>
        </div>
        <div class="modal-footer">
            <ng-container *ngIf="!iscritto">
                <button class="btn primary-button" (click)="iscriviti()" ngbAutofocus>iscriviti</button>
            </ng-container>

            <ng-container *ngIf="iscritto && !simulato">
                <button class="btn primary-button" (click)="simula()">
                    simula
                </button>
            </ng-container>

            <ng-container *ngIf="simulato">
                <button class="btn primary-button" (click)="goToClassifica()" (click)="modal.close( 'Close click' )">
                    vai alla classifica
                </button>
            </ng-container>

            <ng-container *ngIf="!iscritto">
                <button class="btn btn-danger " (click)="modal.dismiss( 'Close click') ">
                    chiudi
                </button>
            </ng-container>

        </div>
    </ng-template>

    <ng-template #dettaglioGlobale let-modal>
        <div class="modal-header">
            <h4 class="modal-title">Dettaglio globale</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                <span aria-hidden="true" id="span-close">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <div *ngFor="let class of classificaGlobale | async">
                <ng-container *ngIf="class.idPlayer == idPlayerPassato">
                    <table class="table-globale">
                        <tr>
                            <td colspan="2"><span class="bolder">{{usernameUtentePassato}}</span></td>
                        </tr>
                        <tr>
                            <td>Punteggio totale</td>
                            <td><button class="btn primary-button">{{class.punteggioTotale}}</button></td>
                        </tr>
                        <tr>
                            <td>Media punti x torneo</td>
                            <td><button class="btn primary-button">{{class.mediaPunteggio}}</button></td>
                        </tr>
                        <tr>
                            <td>Partite giocate</td>
                            <td><button class="btn primary-button">{{class.partiteGiocate}}</button></td>
                        </tr>
                        <tr>
                            <td>Tornei giocati</td>
                            <td><button class="btn primary-button">{{class.torneiGiocati}}</button></td>
                        </tr>
                        <tr>
                            <td>Vittorie</td>
                            <td><button class="btn primary-button">{{class.vittorie}}</button></td>
                        </tr>
                    </table>
                </ng-container>

            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-danger" (click)="modal.dismiss('Close click')" ngbAutofocus>
                chiudi
            </button>
        </div>
    </ng-template>